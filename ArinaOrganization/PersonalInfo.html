<!DOCTYPE html>
<html lang="zh-tw">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LYWG0V3R6H"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-LYWG0V3R6H');
    </script>
    <meta charset="utf-8" />
    <title>人物明細(Personal Information)</title>
    <link rel="stylesheet" href="ArinaPage.css">
</head>
<body>
    <script src="Arina.js"></script>
    <h3 style="text-align:center">人物明細(Personal Information)</h3>
    <div style="text-align:center; width:90%; height:30px; margin:auto">
        <div style="width:20%; text-align:left; float:left"><a id="previous_page" href="#">←</a></div>
        <div style="width:60%; float:left"><a href="javascript:refresh_page()">更新(Refresh)</a></div>
        <div style="width:20%; text-align:right; float:left"><a id="next_page" href="#">→</a></div>
    </div>

    <div id="main" style="text-align:center">
        <table id="personTable" border="1" style="margin-left:auto; margin-right:auto; text-align:center">
            <tr>
                <td width="350px" height="320px" style="padding:20px" colspan="2" rowspan="2">
                    <img id="imgPerson" src="" style="max-width:100%; max-height:100%;" />
                </td>
                <th width="400px">簡介</th>
            </tr>
            <tr><td id="tdDescription" rowspan="13" width="400px" style="text-align:left; vertical-align:top; padding:5px"></td></tr>
            <tr>
                <td id="tdName" colspan="2" style="height:2.5em;"></td>

            </tr>
            <tr>
                <td width="180px">品階</td>
                <td id="tdMoralRank"></td>
            </tr>
            <tr>
                <td>性別</td>
                <td id="tdGender"></td>
            </tr>
            <tr>
                <td>作品名/來源</td>
                <td id="tdFrom"></td>
            </tr>
            <tr>
                <td>虛構人物</td>
                <td id="tdFiction"></td>
            </tr>
            <tr>
                <td>應交付處罰對象</td>
                <td id="tdWanted"></td>
            </tr>
            <tr>
                <td>保護中</td>
                <td id="tdProtected"></td>
            </tr>
            <tr>
                <td>類型</td>
                <td id="tdGroup"></td>
            </tr>
            <tr>
                <td>教籍</td>
                <td id="tdIsAOMember"></td>
            </tr>
            <!--<tr>
                <td>有名人</td>
                <td id="tdIsCelebrity"></td>
            </tr>-->
            <tr>
                <td>Twitter帳號</td>
                <td id="tdTwitter"></td>
            </tr>
            <tr>
                <td>Facebook帳號</td>
                <td id="tdFacebook"></td>
            </tr>
            <tr>
                <td>Instagram帳號</td>
                <td id="tdInstagram"></td>
            </tr>
        </table>
        <br />
    </div>
    <table id="recordTable" border="1" style="margin-left:auto; margin-right:auto; text-align:center">
    </table>
    <br />
    <div style="text-align:center">
        <a href="MoralRank.html">回一覽表</a>
    </div>

    <script>
        function refresh_page() {
            localStorage.clear();
            location.reload(true);
        }

        function get_full_name(name, surname, othername, surnamefirst, yomikata, split_by = " ") {
            var result = "";
            if (surnamefirst == "y")
                result = `${surname}${split_by}${name}`;
            else
                result = `${name}.${surname}`;
            if (othername != "")
                result += `/${othername}`;
            if (yomikata != "")
                result += `<br />(${yomikata})`;
            return result;
        }

        function draw() {
            var PData, BRData;
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    PData = this.response;
                    xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function () {
                        if (this.readyState == 4 && this.status == 200) {
                            BRData = this.response;

                            var ulp = GetURLParameter();
                            var div, a, tr, td, th, img;

                            if (ulp.index != 0)
                                document.getElementById("previous_page").href = `PersonalInfo.html?index=${(parseInt(ulp.index) - 1)}&v=` + Math.random();
                            else
                                document.getElementById("previous_page").parentNode.innerText = "　";
                            if (ulp.index < PData.length - 1)
                                document.getElementById("next_page").href = `PersonalInfo.html?index=${(parseInt(ulp.index) + 1)}&v=` + Math.random();
                            else
                                document.getElementById("next_page").parentNode.innerText = "　";

                            var pTable = document.getElementById("personTable");
                            pTable.innerHTML = ``;
                            pTable.style = `width:${window_size_width}px; margin:auto`;

                            if (window_size == `s` || window_size == `mi` || true) {
                                th = document.createElement(`th`);
                                th.colSpan = 2;

                                img = document.createElement(`img`);
                                img.style = `max-width:100%; max-height:100%`;

                                if (PData[ulp.index].PicturePath != ``)
                                    img.src = `Pictures/${PData[ulp.index].PicturePath}`;
                                else
                                    img.src = `Pictures/X.png`;

                                th.appendChild(img);
                                pTable.appendChild(th);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.colSpan = 2;
                                td.innerHTML = `<b>${get_full_name(PData[ulp.index].Name, PData[ulp.index].Surname, PData[ulp.index].OtherName, PData[ulp.index].SurnameFirst, PData[ulp.index].Yomikata)}</b>`;
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerHTML = `品階(Moral Rank)`;
                                tr.appendChild(td);
                                
                                td = document.createElement(`td`);
                                td.innerHTML = PData[ulp.index].MoralRank;
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerHTML = `性別(Gender)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                if (PData[ulp.index].Gender == "f")
                                    td.innerText = "女(Female)";
                                else if (PData[ulp.index].Gender == "m")
                                    td.innerText = "男(Male)";
                                else
                                    td.innerText = "-";
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerHTML = `作品名/來源(From)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                td.innerText = PData[ulp.index].From;                                
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `虛構人物(Fictional)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                td.innerText = PData[ulp.index].Fiction == "y" ? "○" : "╳";
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `應交付處罰對象(Should be punished by AO)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                td.innerText = PData[ulp.index].Wanted == "y" ? "○" : "╳";
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `保護中(Protected)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                td.innerText = PData[ulp.index].Protected == "y" ? "○" : "╳";
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `類型(Type)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                td.innerText = PData[ulp.index].Group == "g" ? "群體(Group)" : "個人(Individual)";
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `教籍(Membership)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                td.innerText = PData[ulp.index].IsAOMember == "y" ? "○" : "╳";
                                tr.appendChild(td);
                                pTable.appendChild(tr);
                                
                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `Twitter(X)帳戶(Twitter(X) Account)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                if (PData[ulp.index].TwitterAccount != ``) {
                                    a = document.createElement(`a`);
                                    a.target = `_blank`;
                                    a.href = `https://twitter.com/${PData[ulp.index].TwitterAccount}`;
                                    a.innerText = PData[ulp.index].TwitterAccount;
                                    td.appendChild(a);
                                }
                                else
                                    td.innerText = `-`;
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `Facebook帳戶(Facebook Account)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                if (PData[ulp.index].FacebookAccount != ``) {
                                    a = document.createElement(`a`);
                                    a.target = `_blank`;
                                    a.href = `https://facebook.com/${PData[ulp.index].FacebookAccount}`;
                                    a.innerText = PData[ulp.index].FacebookAccount;
                                    td.appendChild(a);
                                }
                                else
                                    td.innerText = `-`;
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.innerText = `Instagram帳戶(Instagram Account)`;
                                tr.appendChild(td);

                                td = document.createElement(`td`);
                                if (PData[ulp.index].InstagramAccount != ``) {
                                    a = document.createElement(`a`);
                                    a.target = `_blank`;
                                    a.href = `https://twitter.com/${PData[ulp.index].InstagramAccount}`;
                                    a.innerText = PData[ulp.index].InstagramAccount;
                                    td.appendChild(a);
                                }
                                else
                                    td.innerText = `-`;
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.colSpan = 2;
                                td.innerText = `簡介(Description)`;
                                tr.appendChild(td);
                                pTable.appendChild(tr);

                                tr = document.createElement(`tr`);
                                td = document.createElement(`td`);
                                td.colSpan = 2;
                                td.style = ``;
                                td.innerText = PData[ulp.index].Description == "" ? "-" : PData[ulp.index].Description;
                                tr.appendChild(td);
                                pTable.appendChild(tr);
                                
                            }

                            document.getElementById(`main`).innerHTML = ``;
                            document.getElementById(`main`).appendChild(pTable);

                            var rTable = document.getElementById("recordTable");

                            rTable.innerHTML = "";

                            tr = document.createElement("tr");
                            td = document.createElement("td");
                            td.style = "width:300px";
                            td.innerText = "時間";
                            tr.appendChild(td);

                            td = document.createElement("td");
                            td.style = "width:50px";
                            td.innerText = "階級";
                            tr.appendChild(td);

                            td = document.createElement("td");
                            td.style = "width:150px";
                            td.innerText = "贈階者";
                            tr.appendChild(td);

                            td = document.createElement("td");
                            td.style = "width:300px";
                            td.innerText = "理由";
                            tr.appendChild(td);

                            rTable.appendChild(tr);

                            for (var i = 0; i < BRData.length; i++) {
                                if (BRData[i].PersonID == PData[ulp.index].ID) {
                                    tr = document.createElement("tr");

                                    td = document.createElement("td");
                                    td.innerHTML = ChangeDateTimeToArDate(BRData[i].BestowDateTime);
                                    tr.appendChild(td);

                                    td = document.createElement("td");
                                    td.innerText = BRData[i].MoralRank;
                                    tr.appendChild(td);

                                    td = document.createElement("td");
                                    a = document.createElement("a")
                                    for (var j = 0; j < PData.length; j++) {
                                        if (PData[j].ID == BRData[i].BestowerID) {
                                            a.innerText = get_full_name(PData[j].Name, PData[j].Surname, PData[j].OtherName, PData[j].SurnameFirst, "", "");
                                            a.href = `PersonalInfo.html?index=${j}&v=` + Math.random();
                                            break;
                                        }
                                    }
                                    td.appendChild(a);
                                    tr.appendChild(td);

                                    td = document.createElement("td");
                                    td.innerText = BRData[i].Reason;
                                    tr.appendChild(td);

                                    rTable.appendChild(tr);
                                }
                            }
                        }
                    }
                    xhttp.responseType = 'json';
                    xhttp.open("GET", "BestowRecords.json?v=" + Math.random(), true);
                    xhttp.send();
                }

            }
            xhttp.responseType = 'json';
            xhttp.open("GET", "Persons.json?v=" + Math.random(), true);
            xhttp.send();

            localStorage.clear();
        }

        function redraw() {
            GetWindowSize();
            draw();
        }

        function main() {
            redraw();
        }

        main();
    </script>
</body>
</html>